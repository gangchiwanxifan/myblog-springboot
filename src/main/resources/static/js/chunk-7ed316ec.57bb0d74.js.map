{"version":3,"sources":["webpack:///./src/views/account/settings/page/PageSettings.vue?c003","webpack:///src/views/account/settings/page/PageSettings.vue","webpack:///./src/views/account/settings/page/PageSettings.vue?5af2","webpack:///./src/views/account/settings/page/PageSettings.vue","webpack:///./src/views/account/settings/page/PageSettings.vue?41b3"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","spinning","ref","staticClass","toolbars","on","imgAdd","model","value","callback","$$v","content","expression","handlePage","_v","staticRenderFns","data","bold","italic","header","underline","strikethrough","mark","superscript","subscript","quote","ol","ul","link","imagelink","code","fullscreen","htmlcode","alignleft","aligncenter","alignright","subfield","preview","computed","userId","$store","state","user","userInfo","mounted","getHomePage","methods","beforeUpload","isJpgOrPng","$message","error","isLt2M","info","$file","file","append","url","method","res","$refs","md","toolbar_left","$imgDelByFilename","name","pageContent","homePage","component"],"mappings":"kJAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,SAAS,CAACE,MAAM,CAAC,SAAWN,EAAIO,WAAW,CAACH,EAAG,eAAe,CAACI,IAAI,KAAKC,YAAY,cAAcH,MAAM,CAAC,mBAAqB,YAAY,SAAWN,EAAIU,UAAUC,GAAG,CAAC,OAASX,EAAIY,QAAQC,MAAM,CAACC,MAAOd,EAAW,QAAEe,SAAS,SAAUC,GAAMhB,EAAIiB,QAAQD,GAAKE,WAAW,aAAad,EAAG,WAAW,CAACK,YAAY,aAAaH,MAAM,CAAC,KAAO,WAAWK,GAAG,CAAC,MAAQX,EAAImB,aAAa,CAACnB,EAAIoB,GAAG,SAAS,IAAI,IACrfC,EAAkB,G,wBCoBtB,GACEC,KADF,WAEI,MAAO,CACLL,QAAS,GACTV,UAAU,EACVG,SAAU,CACRa,MAAM,EACNC,QAAQ,EACRC,QAAQ,EACRC,WAAW,EACXC,eAAe,EACfC,MAAM,EACNC,aAAa,EACbC,WAAW,EACXC,OAAO,EACPC,IAAI,EACJC,IAAI,EACJC,MAAM,EACNC,WAAW,EACXC,MAAM,EAENC,YAAY,EAEZC,UAAU,EAUVC,WAAW,EACXC,aAAa,EACbC,YAAY,EAEZC,UAAU,EACVC,SAAS,KAIfC,SAAU,CACRC,OADJ,WAEM,OAAO5C,KAAK6C,OAAOC,MAAMC,KAAKC,SAASJ,SAG3CK,QA/CF,WAgDIjD,KAAKkD,eAEPC,QAAS,CACPC,aADJ,SACA,GACM,IAAN,EACA,uBACA,sBACA,sBACWC,GACHrD,KAAKsD,SAASC,MAAM,0BAA2B,GAGjD,IAAN,qBAIM,OAHKC,GACHxD,KAAKsD,SAASG,KAAK,eAAgB,GAE9BJ,GAAcG,GAGvB7C,OAjBJ,SAiBA,gBACA,eAEUX,KAAKoD,aAAaM,IACpBC,EAAKC,OAAO,OAAQF,GACpB,OAAR,OAAQ,CAAR,CACUG,IAAK,cACLC,OAAQ,OACRzC,KAAMsC,IAChB,kBACcI,EAAI1C,KAAKA,KACX,EAAZ,kCAEY,EAAZ,yBACY,EAAZ,2DAIQrB,KAAKgE,MAAMC,GAAGD,MAAME,aAAaC,kBAAkBT,EAAMU,OAI7DlB,YAvCJ,WAuCA,WACM,OAAN,OAAM,CAAN,CACQW,IAAK,gBACLC,OAAQ,OACRzC,KAAM,CAAd,sBACA,kBACY0C,EAAI1C,KAAKA,MACX,EAAV,gCACA,wBACA,GACU,EAAV,cAEU,EAAV,6BACU,EAAV,iBAKIH,WAzDJ,WAyDA,WACMlB,KAAKM,UAAW,EAChB,IAAN,GACQsC,OAAQ5C,KAAK4C,OACbyB,YAAarE,KAAKgB,SAEpB,OAAN,OAAM,CAAN,CACQ6C,IAAK,mBACLC,OAAQ,OACRzC,KAAMiD,IACd,kBACYP,EAAI1C,KAAKA,MACX,EAAV,2BACU,EAAV,cAEU,EAAV,2BACU,EAAV,mBChJmY,I,wBCQ/XkD,EAAY,eACd,EACAzE,EACAsB,GACA,EACA,KACA,WACA,MAIa,aAAAmD,E,2CCnBf","file":"js/chunk-7ed316ec.57bb0d74.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-spin',{attrs:{\"spinning\":_vm.spinning}},[_c('mavon-editor',{ref:\"md\",staticClass:\"blog-editor\",attrs:{\"toolbarsBackground\":\"#FA541C11\",\"toolbars\":_vm.toolbars},on:{\"imgAdd\":_vm.imgAdd},model:{value:(_vm.content),callback:function ($$v) {_vm.content=$$v},expression:\"content\"}}),_c('a-button',{staticClass:\"submit-btn\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handlePage}},[_vm._v(\"提交\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <a-spin :spinning=\"spinning\">\n      <mavon-editor\n        class=\"blog-editor\"\n        toolbarsBackground=\"#FA541C11\"\n        :toolbars=\"toolbars\"\n        v-model=\"content\"\n        @imgAdd=\"imgAdd\"\n        ref=\"md\"\n      />\n      <a-button @click=\"handlePage\" type=\"primary\" class=\"submit-btn\"\n        >提交</a-button\n      >\n    </a-spin>\n  </div>\n</template>\n\n<script>\nimport request from \"@/utils/request\";\n\nexport default {\n  data() {\n    return {\n      content: \"\",\n      spinning: true,\n      toolbars: {\n        bold: true, // 粗体\n        italic: true, // 斜体\n        header: true, // 标题\n        underline: true, // 下划线\n        strikethrough: true, // 中划线\n        mark: true, // 标记\n        superscript: true, // 上角标\n        subscript: true, // 下角标\n        quote: true, // 引用\n        ol: true, // 有序列表\n        ul: true, // 无序列表\n        link: true, // 链接\n        imagelink: true, // 图片链接\n        code: true, // code\n        // table: true, // 表格\n        fullscreen: true, // 全屏编辑\n        // readmodel: true, // 沉浸式阅读\n        htmlcode: true, // 展示html源码\n        // help: true, // 帮助\n        /* 1.3.5 */\n        // undo: true, // 上一步\n        // redo: true, // 下一步\n        // trash: true, // 清空\n        // save: true, // 保存（触发events中的save事件）\n        /* 1.4.2 */\n        // navigation: true, // 导航目录\n        /* 2.1.8 */\n        alignleft: true, // 左对齐\n        aligncenter: true, // 居中\n        alignright: true, // 右对齐\n        /* 2.2.1 */\n        subfield: true, // 单双栏模式\n        preview: true, // 预览\n      },\n    };\n  },\n  computed: {\n    userId() {\n      return this.$store.state.user.userInfo.userId;\n    },\n  },\n  mounted() {\n    this.getHomePage();\n  },\n  methods: {\n    beforeUpload(file) {\n      const isJpgOrPng =\n        file.type === \"image/jpeg\" ||\n        file.type === \"image/png\" ||\n        file.type === \"image/webp\";\n      if (!isJpgOrPng) {\n        this.$message.error(\"请上传图片文件! (jpg/pbg/webp)\", 3);\n      }\n      // console.log(file.size);\n      const isLt2M = file.size / 1024 / 1024 < 2;\n      if (!isLt2M) {\n        this.$message.info(\"限制上传图片大小为2MB\", 3);\n      }\n      return isJpgOrPng && isLt2M;\n    },\n    // 将图片上传，返回地址替换到md中\n    imgAdd(pos, $file) {\n      let file = new FormData();\n      // console.log($file);\n      if (this.beforeUpload($file)) {\n        file.append(\"file\", $file);\n        request({\n          url: \"/api/upload\",\n          method: \"post\",\n          data: file,\n        }).then((res) => {\n          if (res.data.data) {\n            this.$refs.md.$img2Url(pos, res.data.data);\n          } else {\n            this.$message.error(\"图片上传出错\");\n            this.$refs.md.$refs.toolbar_left.$imgDelByFilename($file.name);\n          }\n        });\n      } else {\n        this.$refs.md.$refs.toolbar_left.$imgDelByFilename($file.name);\n      }\n    },\n    // 获取用户主页\n    getHomePage() {\n      request({\n        url: \"/homepage/get\",\n        method: \"post\",\n        data: { userId: this.userId },\n      }).then((res) => {\n        if (res.data.data) {\n          this.content = res.data.data.pageContent\n            ? res.data.data.pageContent\n            : \"\";\n          this.spinning = false;\n        } else {\n          this.$message.error(\"获取主页信息失败\", 1);\n          this.spinning = false;\n        }\n      });\n    },\n    // 提交主页\n    handlePage() {\n      this.spinning = true;\n      const homePage = {\n        userId: this.userId,\n        pageContent: this.content,\n      };\n      request({\n        url: \"/homepage/update\",\n        method: \"post\",\n        data: homePage,\n      }).then((res) => {\n        if (res.data.data) {\n          this.$message.success(\"修改成功\", 1);\n          this.spinning = false;\n        } else {\n          this.$message.success(\"修改失败\", 1);\n          this.spinning = false;\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.blog-editor {\n  margin-top: 20px;\n  z-index: 1000 !important;\n}\n.submit-btn {\n  width: 100%;\n  height: 40px;\n  margin-top: 30px;\n  font-size: 18px;\n}\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageSettings.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageSettings.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PageSettings.vue?vue&type=template&id=0977ff70&scoped=true&\"\nimport script from \"./PageSettings.vue?vue&type=script&lang=js&\"\nexport * from \"./PageSettings.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PageSettings.vue?vue&type=style&index=0&id=0977ff70&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0977ff70\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageSettings.vue?vue&type=style&index=0&id=0977ff70&lang=less&scoped=true&\""],"sourceRoot":""}